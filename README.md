# 🧮 Engineering Calculator (공학용 계산기)

브라우저에서 바로 실행할 수 있는 단일 HTML 계산기 애플리케이션입니다. 기본 사칙연산(덧셈, 뺄셈, 곱셈, 나눗셈)과 퍼센트 계산 기능을 제공하며, 모던한 다크 테마 UI와 키보드 지원을 갖추고 있습니다.

> **사용자 요청:** 계산기 앱 만들어줘. 기본 사칙연산과 퍼센트 계산 기능이 필요해. HTML에서 실행할 수 있는 단일 HTML 프로그램으로 만들어줘.

## 🛠️ 기술 스택

| 구분 | 기술 |
|------|------|
| 마크업 | HTML5 |
| 스타일 | CSS3 (인라인 `<style>`) — CSS Grid, CSS Custom Properties, 반응형 디자인 |
| 로직 | Vanilla JavaScript (ES6+, 인라인 `<script>`) |
| 폰트 | Google Fonts — DM Mono (디스플레이), Outfit (UI) |
| 테스트 | Jest 29 + jsdom |
| 아키텍처 | 단일 파일 (Single-file Application) — 빌드 도구, 서버, 프레임워크 불필요 |

---

## 📁 프로젝트 구조

```
aiagent_20260213_153346/
├── index.html              # 📱 메인 애플리케이션 (HTML + CSS + JS 올인원)
├── package.json            # 📦 프로젝트 메타데이터 및 Jest 의존성
├── jest.config.js          # ⚙️ Jest 테스트 환경 설정 (jsdom)
├── tests/
│   └── test_main.js        # 🧪 전체 테스트 스위트 (40개 테스트 케이스)
├── node_modules/           # 📚 npm 의존성 (테스트용)
└── .projecthub/
    └── ai-agent/
        └── docs/
            ├── RESEARCH.md       # 요구사항 분석 및 기술 리서치
            ├── PRD.md            # 제품 요구사항 문서
            ├── FILE_STRUCTURE.md # 파일 구조 문서
            └── TEST_PLAN.md     # 테스트 계획서
```

### 파일별 역할

| 파일 | 역할 | 설명 |
|------|------|------|
| `index.html` | **메인 애플리케이션** | 계산기 UI, 스타일링, 로직이 모두 포함된 단일 파일. 브라우저에서 직접 열어 사용 |
| `package.json` | 프로젝트 설정 | Jest 테스트 프레임워크 의존성 관리 |
| `jest.config.js` | 테스트 설정 | jsdom 환경에서 테스트 실행을 위한 Jest 설정 |
| `tests/test_main.js` | 테스트 코드 | 13개 카테고리, 40개 테스트 케이스 |

---

## ✨ 주요 기능

### 🔢 기본 사칙연산
| 연산 | 기호 | 예시 |
|------|------|------|
| 덧셈 | + | `5 + 3 = 8` |
| 뺄셈 | − | `10 - 4 = 6` |
| 곱셈 | × | `6 × 7 = 42` |
| 나눗셈 | ÷ | `15 ÷ 3 = 5` |

### 📊 퍼센트 계산
- **수식 내 퍼센트:** `100 + 10%` → `110` (100의 10%인 10을 더함)
- **단독 퍼센트:** `50%` → `0.5` (50을 100으로 나눔)
- **감산 퍼센트:** `200 - 25%` → `150` (200의 25%인 50을 뺌)

### 🎛️ 유틸리티 기능
| 기능 | 버튼 | 설명 |
|------|------|------|
| 초기화 | C | 계산기를 초기 상태로 리셋 |
| 부호 전환 | ± | 양수/음수 전환 |
| 소수점 | . | 소수점 입력 |
| 등호 | = | 현재 수식 계산 |
| 백스페이스 | ← (키보드) | 마지막 숫자 삭제 |

### ⌨️ 키보드 지원
| 키 | 동작 |
|----|------|
| `0`-`9` | 숫자 입력 |
| `+`, `-`, `*`, `/` | 연산자 |
| `%` | 퍼센트 |
| `.` | 소수점 |
| `Enter` / `=` | 계산 실행 |
| `Escape` | 초기화 (C) |
| `Backspace` | 마지막 숫자 삭제 |

### 🎨 UI/UX 특징
- **다크 테마:** 모던한 어두운 배경에 골드 톤 오렌지 악센트
- **이중 디스플레이:** 수식 라인 + 결과값 라인
- **반응형 디자인:** 데스크톱과 모바일 모두 지원 (320px~)
- **버튼 애니메이션:** 호버, 클릭 시 시각적 피드백
- **자동 글씨 크기 조정:** 숫자 길이에 따라 디스플레이 폰트 크기 자동 조절
- **연산자 하이라이트:** 현재 선택된 연산자 버튼 강조 표시

### 🛡️ 에러 처리
- **0으로 나누기:** "Error" 표시 후 숫자 입력이나 C 버튼으로 복구
- **부동소수점 정밀도:** `0.1 + 0.2 = 0.3` (JavaScript 부동소수점 아티팩트 제거)
- **입력 제한:** 최대 15자리 입력으로 오버플로우 방지
- **매우 큰/작은 수:** 자동 지수 표기법 전환

---

## 🚀 실행 방법

### 사전 요구사항
- 모던 웹 브라우저 (Chrome 90+, Firefox 90+, Safari 14+, Edge 90+)

### 실행

가장 간단한 방법 — 파일을 브라우저에서 직접 열기:

```bash
# macOS
open index.html

# Windows
start index.html

# Linux
xdg-open index.html
```

또는 `index.html` 파일을 브라우저 창에 드래그 앤 드롭하면 됩니다.

> 💡 **서버 불필요:** 외부 리소스 없이 동작하므로 로컬 서버 없이도 모든 기능이 작동합니다. (폰트는 온라인 시 Google Fonts에서 로드, 오프라인 시 시스템 폰트로 대체)

---

## 🧪 테스트

### 테스트 환경 설치

```bash
npm install
```

### 테스트 실행

```bash
npm test
```

### 테스트 커버리지 요약

총 **40개 테스트 케이스**, 13개 카테고리:

| # | 카테고리 | 테스트 수 | 설명 |
|---|----------|-----------|------|
| 1 | 초기 상태 | 2 | 로드 시 디스플레이 및 수식 라인 확인 |
| 2 | 숫자 입력 | 7 | 단일/다중 숫자, 소수점, 선행 0, 입력 제한 |
| 3 | 기본 사칙연산 | 7 | 덧셈, 뺄셈, 곱셈, 나눗셈, 음수, 소수 결과, 큰 수 |
| 4 | 연산자 체이닝 | 2 | 연속 연산, 중간 결과 표시 |
| 5 | 퍼센트 계산 | 3 | 수식 내 퍼센트, 단독 퍼센트, 감산 퍼센트 |
| 6 | 0으로 나누기 | 3 | 에러 표시, C로 복구, 숫자 입력 복구 |
| 7 | 초기화 (C) | 2 | 디스플레이 리셋, 연산 중 리셋 |
| 8 | 부호 전환 (±) | 3 | 양→음, 음→양, 0 처리 |
| 9 | 백스페이스 | 3 | 숫자 삭제, 0 리셋, 에러 상태 보호 |
| 10 | 부동소수점 정밀도 | 2 | `0.1+0.2=0.3`, `0.3-0.1=0.2` |
| 11 | 키보드 지원 | 7 | 숫자, 연산자, Enter, Escape, Backspace, 소수점, % |
| 12 | 수식 표시 | 2 | 연산 중 수식, 등호 후 전체 수식 |
| 13 | 에지 케이스 | 4 | 빈 등호, 연속 등호, 연산자 교체, 계산 후 새 입력 |

### 테스트 전략
- **통합 테스트:** 실제 DOM 이벤트(클릭, 키보드)를 시뮬레이션하여 사용자 관점에서 테스트
- **jsdom 환경:** `index.html`을 통째로 로드하여 실제 브라우저와 동일한 환경 재현
- **모킹 없음:** 실제 계산기 로직을 그대로 실행하여 신뢰도 높은 테스트

---

## 📊 품질 지표

### Self-Healing 결과
| 항목 | 결과 |
|------|------|
| 시도 횟수 | 1회 |
| 상태 | ✅ 성공 |

### 코드 품질 평가

| 항목 | 평가 |
|------|------|
| **아키텍처** | 단일 IIFE 패턴으로 전역 스코프 오염 방지 — `'use strict'` 모드 적용 |
| **상태 관리** | 명확한 상태 변수 6개 (`currentValue`, `previousValue`, `operator`, `shouldResetDisplay`, `lastExpression`, `justEvaluated`)로 계산기 상태머신 구현 |
| **CSS 설계** | CSS Custom Properties(변수)를 활용한 일관된 테마 시스템, CSS Grid 기반 레이아웃 |
| **접근성** | 시맨틱 `<button>` 요소 사용, `:focus-visible` 포커스 스타일, `user-scalable=no` 뷰포트 설정 |
| **에러 처리** | 0 나누기, 무한대, NaN 등 모든 수학적 에지 케이스를 안전하게 처리 |
| **성능** | 외부 리소스 최소화, DOM 이벤트 위임 패턴 사용 (버튼 그리드에 단일 이벤트 리스너) |

---

## 📋 작업 요약

| 항목 | 내용 |
|------|------|
| **총 소요 시간** | 12분 30초 |
| **개발 방식** | TDD (Test-Driven Development) |
| **파일 수** | 4개 (index.html, package.json, jest.config.js, tests/test_main.js) |
| **코드 라인** | ~627줄 (index.html) + ~551줄 (test_main.js) |
| **테스트 케이스** | 40개 (13개 카테고리) |
| **Self-Healing** | 1회 시도, 성공 |

### 진행 단계

| 단계 | 내용 | 상태 |
|------|------|------|
| 1. 리서치 | 요구사항 분석, 기술 스택 결정 | ✅ 완료 |
| 2. 문서화 | PRD, 테스트 계획서, 파일 구조 문서 작성 | ✅ 완료 |
| 3. TDD 레드 | 테스트 코드 작성 (40개 테스트 케이스) | ✅ 완료 |
| 4. TDD 그린 | 메인 애플리케이션 구현 | ✅ 완료 |
| 5. 검증 | 테스트 실행 및 Self-Healing | ✅ 완료 |
| 6. UI 검수 | 비전 체크 (시각적 품질 확인) | ✅ 완료 |

---

## 🔮 향후 개선 사항

### 추가 기능
- **계산 히스토리:** 이전 계산 기록 확인 및 재사용
- **메모리 기능:** M+, M-, MR, MC 메모리 연산
- **공학용 함수:** sin, cos, tan, log, ln, √, xⁿ 등 과학 계산 기능
- **단위 변환:** 길이, 무게, 온도 등 단위 변환 모드
- **테마 전환:** 다크/라이트 모드 토글

### 코드 개선
- **오프라인 폰트:** Google Fonts 의존성 제거를 위한 폰트 인라인 또는 시스템 폰트 전용 모드
- **PWA 지원:** Service Worker 추가로 오프라인 설치형 앱 구현
- **접근성 강화:** ARIA 레이블, 스크린리더 지원 개선
- **다국어 지원:** 한국어/영어 UI 전환 기능
- **애니메이션 향상:** 숫자 전환 시 슬라이드/페이드 애니메이션
